<script>
  import { competitionStatus, competitionInfo } from '$lib/stores';
</script>

<svelte:head>
  <title>OWLCMS Competition Tracker</title>
</svelte:head>

<div class="container">
  <header class="text-center mb-3">
    <h1>🏋️ OWLCMS Competition Tracker</h1>
    {#if $competitionInfo.name}
      <h2>{$competitionInfo.name}</h2>
      <p>
        {$competitionInfo.date} • Session {$competitionInfo.currentSession}
      </p>
    {/if}
  </header>

  {#if $competitionStatus === 'ready'}
    <div class="plugins">
      <h3>Available Views</h3>
      <div class="plugin-grid">
        <a href="/leaderboard" class="plugin-card">
          <h4>📊 Leaderboard</h4>
          <p>Overall competition rankings</p>
        </a>
        
        <a href="/currentLifter" class="plugin-card">
          <h4>🎯 Current Lifter</h4>
          <p>Live attempt display with timer</p>
        </a>
        
        <a href="/teamStandings" class="plugin-card">
          <h4>🏆 Team Standings</h4>
          <p>Team rankings and scores</p>
        </a>
        
        <a href="/weightClass" class="plugin-card">
          <h4>⚖️ Weight Classes</h4>
          <p>Results by weight category</p>
        </a>
        
        <a href="/liftingOrder" class="plugin-card">
          <h4>📋 Lifting Order</h4>
          <p>Current lifting order</p>
        </a>
        
        <a href="/records" class="plugin-card">
          <h4>🥇 Records</h4>
          <p>Competition records tracker</p>
        </a>
      </div>
    </div>
  {:else if $competitionStatus === 'waiting'}
    <div class="status text-center">
      <h3>⏳ Waiting for Competition Data</h3>
      <p>The system is waiting for data from the competition management system.</p>
      <p>Please ensure the OWLCMS backend is running and connected.</p>
    </div>
  {:else if $competitionStatus === 'error'}
    <div class="error text-center">
      <h3>❌ Connection Error</h3>
      <p>Unable to connect to the competition system.</p>
      <button on:click={() => window.location.reload()}>🔄 Refresh Page</button>
    </div>
  {:else}
    <div class="status text-center">
      <h3>🔄 Connecting...</h3>
      <p>Establishing connection to competition system...</p>
    </div>
  {/if}

  <footer class="text-center mt-3">
    <p class="text-secondary">
      Connection Status: 
      <span class="status-indicator" class:ready={$competitionStatus === 'ready'} 
            class:waiting={$competitionStatus === 'waiting'} 
            class:error={$competitionStatus === 'error'}>
        {$competitionStatus}
      </span>
    </p>
  </footer>
</div>

<style>
  .plugin-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
  }
  
  .plugin-card {
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1.5rem;
    text-decoration: none;
    color: inherit;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  
  .plugin-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    text-decoration: none;
  }
  
  .plugin-card h4 {
    margin: 0 0 0.5rem 0;
    color: var(--primary-color);
  }
  
  .plugin-card p {
    margin: 0;
    color: var(--text-secondary);
    font-size: 0.9rem;
  }
  
  .status {
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 2rem;
  }
  
  .error {
    background: #ffebee;
    border: 1px solid #ffcdd2;
    border-radius: 8px;
    padding: 2rem;
    color: var(--error-color);
  }
  
  .status-indicator {
    font-weight: bold;
    text-transform: uppercase;
    font-size: 0.8rem;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
  }
  
  .status-indicator.ready {
    background: #e8f5e8;
    color: var(--success-color);
  }
  
  .status-indicator.waiting {
    background: #fff3e0;
    color: var(--warning-color);
  }
  
  .status-indicator.error {
    background: #ffebee;
    color: var(--error-color);
  }
  
  .text-secondary {
    color: var(--text-secondary);
    font-size: 0.9rem;
  }
</style>